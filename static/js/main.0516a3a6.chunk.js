(this.webpackJsonpexaminator=this.webpackJsonpexaminator||[]).push([[0],{105:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),c=n.n(i),o=(n(105),n(9)),s=n.n(o),u=n(15),l=n(8),d=n(89),j=n(208),b=n(25),f=n(161),p=n(22),h=n(45),m=function e(t){var n=this;Object(h.a)(this,e),this.db=void 0,this.dbname="",this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{READ_WRITE:"readwrite"},this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,this.createConn=function(){var e=n;return new Promise((function(t,a){var r=n.indexedDB.open(n.dbname);r.onupgradeneeded=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;n&&(n.createObjectStore("questions",{keyPath:"id"}),n.createObjectStore("exams",{keyPath:"id"})),console.log("DB settled")},r.onerror=function(e){a("You didn't allow the app to create a Local Database")},r.onsuccess=function(n){e.db=r.result,console.log(e.db),navigator.storage.persisted().then((function(e){e?t(""):navigator.storage.persist().then((function(e){t(e?"":'Su base de datos se cre\xf3 correctamente, pero se borrar\xe0 cuando cierre el navegador.\nEn el apartado "gestionar preguntas" puede activar la persistencia de sus datos con el bot\xf3n de guardar DB.')}))}))}}))},this.toByteSize=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=["Bytes","KB","MB","GB","TB","PB","ZB"],n=t.length-1,a=0;e>1024&&a<n;)e/=1024,a++;return e.toFixed(2)+" "+t[a]},this.space=function(){return navigator.storage.estimate().then((function(e){var t=e.quota,a=e.usage;return{used_p:t&&a&&a/t*100||0,descr:"S'han utilitzat ".concat(n.toByteSize(a)," de ").concat(n.toByteSize(t))}}))},this.single=function(e,t){var a=n;return new Promise((function(n,r){var i,c=null===(i=a.db)||void 0===i?void 0:i.transaction(e,"readonly").objectStore(e).get(t);c?(c.onerror=r,c.onsuccess=function(e){return n(e.target.result)}):r("Cannot open transaction")}))},this.list=function(e,t,a){var r=n,i=function(e){return e},c=function(e){return!0};return"function"===typeof t?c=t:t&&(i=a&&"include"!==a?"string"===typeof t?function(e){return delete e[t],e}:function(e){return t.reduce((function(e,t){return delete e[t],e}),e)}:"string"===typeof t?function(e){return e[t]}:function(e){return t.reduce((function(t,n){return t[n]=e[n],t}),{})}),new Promise((function(t,n){var a,o=null===(a=r.db)||void 0===a?void 0:a.transaction(e,"readonly").objectStore(e),s=null===o||void 0===o?void 0:o.openCursor(),u=[];s?(s.onerror=n,s.onsuccess=function(e){var n=e.target.result;n?(c(n.value)&&u.push(i(n.value)),n.continue()):t(u)}):n("Cannot open transaction with cursor")}))},this.randomId=function(e){return Array.from(window.crypto.getRandomValues(new Uint8Array(e/2))).map((function(e){return e.toString(16).padStart(2,"0")})).join("")},this.post=function(e,t){var a=n;return new Promise((function(n,r){var i,c=null===(i=a.db)||void 0===i?void 0:i.transaction(e,"readwrite"),o=null===c||void 0===c?void 0:c.objectStore(e);if(!c||!o)return r("Error initializing transaction");Array.isArray(t)?t.forEach((function(e){e.id||(e.id=a.randomId(10)),null===o||void 0===o||o.add(e)})):(t.id||(t.id=a.randomId(10)),null===o||void 0===o||o.add(t)),c.oncomplete=function(){return n(null)},c.onerror=function(e){return r(e.toString())}}))},this.put=function(){var e=Object(u.a)(s.a.mark((function e(t,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n,e.abrupt("return",new Promise((function(e,n){var i,c=null===(i=r.db)||void 0===i?void 0:i.transaction(t,"readwrite"),o=null===c||void 0===c?void 0:c.objectStore(t);if(!c||!o)return n("Error initializing transaction");Array.isArray(a)?a.forEach((function(e){null===o||void 0===o||o.put(e)})):null===o||void 0===o||o.put(a),c.oncomplete=function(){return e(null)},c.onerror=function(e){return n(e.toString())}})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.delete=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteLocalDB=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.db){e.next=3;break}return t=n,e.abrupt("return",new Promise((function(e,n){var a;null===(a=t.db)||void 0===a||a.close();var r=t.indexedDB.deleteDatabase(t.dbname);r.onsuccess=e,r.onerror=n})));case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e)}))),this.dbname=t},x={_events:{},dispatch:function(e,t){this._events[e]&&this._events[e].forEach((function(e){return e(t)}))},subscribe:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},unsubscribe:function(e){this._events[e]&&delete this._events[e]}},g=new function e(){var t=this;Object(h.a)(this,e),this.URL="http://example.com/example",this.LDB="examinatordb",this.db=void 0,this.canLocal=Boolean(window.indexedDB),this.categories=void 0,this.cattree=void 0,this.login=function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("local"!==n){e.next=6;break}if(t.canLocal){e.next=3;break}return e.abrupt("return",Promise.reject("No se puede conectar a la base de datos local... Prueba otro navegador."));case 3:t.db=new m(t.LDB),e.next=7;break;case 6:return e.abrupt("return",Promise.reject("Not Implemented"));case 7:return e.next=9,null===(a=t.db)||void 0===a?void 0:a.createConn();case 9:return(r=e.sent)&&setTimeout((function(){return alert(r)}),500),t.loadCategories(),e.abrupt("return","");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isLocal=function(){return t.db&&t.db instanceof m},this.catToTree=function(e,t){var n=function(t){var n=e,a=t.split("/");0!==a.length&&(a.forEach((function(e){n[e]||(n[e]={__nq:0}),n=n[e]})),n.__nq+=1)};Array.isArray(t)?t.forEach(n):n(t)},this.loadCategories=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,t.db.list("questions","cat");case 5:n=e.sent,t.cattree={__nq:0},n.length>0?(n=n.flat(),t.categories=Object(p.a)(new Set(n)),t.catToTree(t.cattree,n)):t.categories=[],x.dispatch("categories"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("loadCategories",e.t0);case 14:return e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),this.updateCategories=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Array.isArray(n)||(n=[n]),t.categories||(t.categories=[],t.cattree={__nq:0}),n.forEach((function(e){return e.cat.forEach((function(e){t.categories&&t.cattree&&-1===t.categories.indexOf(e)&&(t.categories.push(e),t.catToTree(t.cattree,e))}))})),x.dispatch("categories");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createQuestions=function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&0!==(null===n||void 0===n?void 0:n.length)){e.next=2;break}return e.abrupt("return","No elements to create");case 2:return e.next=4,null===(a=t.db)||void 0===a?void 0:a.post("questions",n);case 4:if(!(r=e.sent)){e.next=9;break}throw new Error(r);case 9:return e.next=11,t.updateCategories(n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createExam=function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r,i,c,o,u,l,d,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Exam: ",n),o=(c="|\xe7|")+n.cat.join(c),e.next=4,null===(a=t.db)||void 0===a?void 0:a.list("questions",(function(e){return!!e.cat.find((function(e){return-1!==o.indexOf(c+e)}))}));case 4:if(u=e.sent){e.next=9;break}throw new Error("Problema con la DB al obtener preguntas");case 9:if(!(u.length<n.qnum)){e.next=13;break}throw new Error("No hay suficientes preguntas en las categorias seleccionadas.\nSelecciona m\xe1s categorias o introduce m\xe1s preguntas.");case 13:for(l=0,d=0;d<n.qnum;d++)l=Math.floor(Math.random()*u.length),n.que.push(u[l].id),n.ans.push(u[l].ans),n.qpans.push(u[l].resp.length),n.res.push(""),u.splice(l,1);case 15:return n.id=(null===(r=t.db)||void 0===r?void 0:r.randomId(30))||"",n.start=Date.now()+1e3,n.end=0,e.next=20,null===(i=t.db)||void 0===i?void 0:i.post("exams",n);case 20:if(!(j=e.sent)){e.next=23;break}throw new Error(j);case 23:return e.abrupt("return",n.id);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getQuestion=function(e){if(!t.db)throw"No DB Connection";return t.db.single("questions",e)},this.getQuestions=function(e){if(!t.db)throw"No DB Connection";return t.db.list("questions",(function(t){return-1!==t.cat.indexOf(e)}))},this.modifyQuestion=function(e){if(!t.db)throw"No DB Connection";t.db.put("questions",e)},this.addCategoryToQuestion=function(){var e=Object(u.a)(s.a.mark((function e(n,a){var r,i,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}throw"No DB Connection";case 2:r=null,i=[],c=0;case 4:if(!(c<n.length)){e.next=12;break}return e.next=7,null===(o=t.db)||void 0===o?void 0:o.single("questions",n[c]);case 7:(r=e.sent)&&-1===r.cat.indexOf(a)&&(r.cat.push(a),i.push(r));case 9:c++,e.next=4;break;case 12:i.length>0&&t.db.put("questions",i);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.getExam=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}throw"No DB Connection";case 2:return e.abrupt("return",t.db.single("exams",n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getExams=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}throw"No DB Connection";case 2:return e.abrupt("return",t.db.list("exams"));case 3:case"end":return e.stop()}}),e)}))),this.saveAnswer=function(){var e=Object(u.a)(s.a.mark((function e(n,a,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}throw"No DB Connection";case 2:return n.res[a]=r,e.abrupt("return",t.db.put("exams",n));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),this.endExam=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.db){e.next=2;break}throw"No DB Connection";case 2:return n.end=Date.now(),e.abrupt("return",t.db.put("exams",n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};function O(){var e=Object(a.useState)(g.categories),t=Object(l.a)(e,2),n=t[0],r=t[1];return x.subscribe("categories",(function(){return r(g.categories)})),n}var v=n(159),y=n(214),w=n(162),k=n(163),C=n(209),S=n(166),q=n(167),N=n(2),E=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},halfwidth:{minWidth:"50vw"},addpadding:{paddingLeft:16,paddingRight:16}})}));function B(e){var t=e.doLogIn,n=E(Object(b.a)()),a=g.canLocal,i=r.a.useState(),c=Object(l.a)(i,2),o=c[0],d=c[1],j=void 0!==o&&!o,p=function(){var e=Object(u.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o){e.next=3;break}return e.abrupt("return",d(""));case 3:return e.next=5,t(o);case 5:(a=e.sent)&&(console.log(a),d(""));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.useEffect((function(){t("local")}),[]),Object(N.jsxs)("div",{className:n.root,children:[Object(N.jsx)(f.a,{}),Object(N.jsxs)(w.a,{variant:"outlined",children:[Object(N.jsx)(k.a,{children:Object(N.jsx)("form",{noValidate:!0,onSubmit:p,autoComplete:"off",children:Object(N.jsx)(C.a,{autoFocus:!0,required:!0,error:j,id:"outlined-error-helper-text",label:"Api Key",onChange:function(e){return d(e.target.value)},className:n.halfwidth,helperText:j?"Incorrect entry.":"",variant:"outlined"})})}),Object(N.jsxs)(S.a,{className:n.addpadding,children:[Object(N.jsx)(q.a,{size:"small",disabled:!o,onClick:p,children:"Connect!"}),Object(N.jsx)(q.a,{size:"small",disabled:!a,onClick:function(){return t("local")},children:"Local"})]})]})]})}var I=n(18),D=n(179),P=n(180),A=n(181),T=n(168),M=n(40),R=n(183),L=n(185),_=n(187),z=n(165),Q=n(123),F=n(188),H=n(171),W=n(213),G=n(192),U=n(193),V=n(182),K=n(184),J=n(186),Y=n(173),X=n(189),Z=n(190),$=n(191),ee=n(16),te=n(19),ne=n(210),ae=n(122),re=n(172),ie=n(127),ce=n(215),oe=n(175),se=n(212),ue=n(76),le=Object(v.a)((function(e){return Object(y.a)({stickypaper:{display:"flex",flexDirection:"column",padding:"5vh 5vw"}})}));function de(e){var t=le();return Object(N.jsx)(ue.a,Object(I.a)(Object(I.a)({},e),{},{className:t.stickypaper+(e.className?" "+e.className:""),elevation:e.elevation||3,children:e.children}))}function je(e){return r.a.useReducer((function(t,n){var a={};return null===n?Object(I.a)({},e):(Object.keys(t).forEach((function(e){var r;"function"===typeof n[e]?(Array.isArray(t[e])?a[e]=Object(p.a)(t[e]):"object"===typeof t[e]&&(a[e]=Object(I.a)({},t[e])),n[e](a[e])):a[e]=null!==(r=n[e])&&void 0!==r?r:t[e]})),a)}),e)}var be=n(170),fe=n(174),pe=n(176),he=n(177),me=n(178),xe=n(169),ge=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},flform:{display:"flex",flexDirection:"column",margin:"10px 0","&>.with-margin>*":{margin:10},"&>:not(.with-margin)":{margin:10}}})}));function Oe(e){var t=e.setSnack,n=ge(),i=O(),c=Object(te.g)(),o=c.catname,d=c.qid,j=Object(te.f)(),b=r.a.useState(!0),f=Object(l.a)(b,2),p=f[0],h=f[1],m=r.a.useState(""),x=Object(l.a)(m,2),v=x[0],y=x[1],w=r.a.useState([]),k=Object(l.a)(w,2),S=k[0],E=k[1],B=r.a.useState(!1),D=Object(l.a)(B,2),P=D[0],A=D[1],R=je({id:"",enun:"",cat:[],resp:[],ans:[],obs:""}),L=Object(l.a)(R,2),_=L[0],F=L[1];Object(a.useEffect)((function(){navigator.storage.persisted().then(h)}),[]),Object(a.useEffect)((function(){d&&g.getQuestion(d).then((function(e){if(!e)return j.replace("/preguntas/gestionar/"+o);e.ans=e.ans.split("|").map((function(e){return+e})),console.log(e),F(e)})),o?(y(""),g.getQuestions(decodeURIComponent(o)).then((function(e){if(!e||0===e.length)return j.replace("/preguntas/gestionar");E(e)}))):E([])}),[o,d]);var W=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),A(!0),e.prev=2,!(_&&_.id&&_.enun&&_.cat.length>0&&_.resp.length>0&&_.ans.length>0)){e.next=11;break}return console.log(_),_.ans=_.ans.sort((function(e,t){return e-t})).join("|"),e.next=8,g.modifyQuestion(_);case 8:t({open:!0,status:"success",msg:"Pregunta modificada!"}),F({id:""}),j.goBack();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),t({open:!0,status:"error",msg:"Error: "+e.t0.toString()});case 16:A(!1);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.storage.persisted();case 3:if(n=e.sent){e.next=8;break}return e.next=7,navigator.storage.persist();case 7:n=e.sent;case 8:h(n),t(n?{open:!0,status:"success",msg:"DB Guardada!"}:{open:!0,status:"error",msg:"No se pudo persistir!"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t({open:!0,status:"error",msg:"Error al persistir DB: "+e.t0.toString()});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(N.jsxs)("div",{className:n.root,children:[!p&&Object(N.jsxs)(ne.a,{style:{margin:10},severity:"warning",action:Object(N.jsx)(q.a,{color:"inherit",size:"small",onClick:G,children:"Persistir"}),children:[Object(N.jsx)(xe.a,{children:"Cuidado!"}),"Tus preguntas y examenes ",Object(N.jsx)("strong",{children:"no se van a guardar"})," si apagas el navegador ya que la base de datos en tu navegador no es persistente.",Object(N.jsx)("br",{}),'Para permitir que se guarde pulsa el bot\xf3n "Persistir".',Object(N.jsx)("br",{}),Object(N.jsx)("strong",{children:"Si estas en Chrome, tendr\xe1s que guardar la pagina como direcci\xf3n de inter\xe9s para que funcione."})]}),Object(N.jsxs)(de,{style:{minWidth:"50%"},children:[Object(N.jsx)(C.a,{value:v,onChange:function(e){return y(e.target.value)},variant:"outlined",placeholder:"Busca "+(o?"preguntas":"categorias"),InputProps:{endAdornment:Object(N.jsx)(be.a,{})}}),Object(N.jsxs)("div",{style:{overflow:"hidden"},children:[Object(N.jsx)(ae.a,{direction:"right",in:0===S.length,mountOnEnter:!0,unmountOnExit:!0,children:Object(N.jsx)(z.a,{children:null===i||void 0===i?void 0:i.filter((function(e){return e.includes(v)})).map((function(e,t){return Object(N.jsxs)(Q.a,{component:ee.b,button:!0,to:"/preguntas/gestionar/"+encodeURIComponent(e),children:[Object(N.jsx)(H.a,{primary:e}),Object(N.jsx)(re.a,{children:Object(N.jsx)(Y.a,{})})]},t)}))})}),Object(N.jsx)(ae.a,{direction:"left",in:S.length>0,mountOnEnter:!0,unmountOnExit:!0,children:Object(N.jsx)(z.a,{children:S.filter((function(e){return e.enun.includes(v)})).map((function(e,t){return Object(N.jsxs)(Q.a,{component:ee.b,button:!0,to:"/preguntas/gestionar/".concat(o,"/").concat(encodeURIComponent(e.id)),children:[Object(N.jsx)(H.a,{primary:e.enun.length>100?e.enun.substr(0,100)+"...":e.enun}),Object(N.jsx)(re.a,{children:Object(N.jsx)(fe.a,{})})]},t)}))})})]})]}),d&&_.id&&Object(N.jsx)(ie.a,{className:n.backdrop,open:!0,children:Object(N.jsx)(de,{style:{maxHeight:"100%",overflow:"auto"},children:Object(N.jsxs)("form",{id:"create-form",className:n.flform,noValidate:!0,onSubmit:W,autoComplete:"off",children:[Object(N.jsx)(M.a,{variant:"h6",children:"Modificaci\xf3n de pregunta"}),Object(N.jsx)(C.a,{required:!0,multiline:!0,error:P&&!_.enun,label:"Enunciado",value:_.enun,onChange:function(e){return F({enun:e.target.value})},helperText:P&&!_.enun?"Un problema necessita su enunciado":"",variant:"outlined"}),Object(N.jsx)(se.a,{freeSolo:!0,multiple:!0,value:_.cat,onChange:function(e,t){F({cat:t})},options:i||[],defaultValue:[],style:{display:"flex"},renderTags:function(e,t){return e.map((function(e,n){return Object(N.jsx)(ce.a,Object(I.a)({variant:"outlined",label:e},t({index:n})))}))},renderInput:function(e){return Object(N.jsx)(C.a,Object(I.a)(Object(I.a)({},e),{},{variant:"outlined",label:"Categorias",style:{flex:"1",maxWidth:"100%"},multiline:!0,error:P&&0===_.cat.length,helperText:P&&0===_.cat.length?"Introduce al menos una categoria":""}))}}),_.resp.map((function(e,t){return Object(N.jsx)(C.a,{required:!0,multiline:!0,label:"Respuesta "+(t+1),variant:"outlined",size:"small",value:e,onChange:function(e){return F({resp:function(n){return n[t]=e.target.value}})},error:P&&!e,helperText:P&&!e?"No pueden haber respuestas vacias! Si no te gusta, elim\xednala":"",InputProps:{endAdornment:Object(N.jsxs)(oe.a,{position:"end",children:[Object(N.jsx)(T.a,{"aria-label":"Marcar como respuesta correcta",onClick:function(){return F({ans:function(e){var n=e.indexOf(t);-1===n?e.push(t):e.splice(n,1)}})},edge:"start",children:-1!==_.ans.indexOf(t)?Object(N.jsx)(pe.a,{style:{color:"#00c100"}}):Object(N.jsx)(he.a,{})}),Object(N.jsx)(T.a,{"aria-label":"Eliminar respuesta",onClick:function(){return F({ans:function(e){var n=e.indexOf(t);-1!==n&&e.splice(n,e.index)},resp:function(e){return e.splice(t,1)}})},edge:"end",children:Object(N.jsx)(me.a,{})})]})}},t)})),Object(N.jsx)(q.a,{variant:"outlined",color:"primary",style:{width:"fit-content",margin:10},onClick:function(){return F({resp:function(e){return e.push("")}})},children:"A\xf1adir respuesta"}),Object(N.jsx)(C.a,{multiline:!0,label:"Observaciones",value:_.obs,onChange:function(e){return F({obs:e.target.value})},variant:"outlined"}),Object(N.jsxs)("div",{children:[Object(N.jsx)(q.a,{type:"submit",variant:"contained",color:"primary",style:{width:"fit-content"},children:"Modificar"}),Object(N.jsx)(q.a,{color:"secondary",onClick:j.goBack,style:{width:"fit-content",marginLeft:10},children:"Cancelar"})]})]})})})]})}var ve=240,ye=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex"},title:{color:"inherit",textDecoration:"none"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(ve,"px)"),marginLeft:ve,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:ve,flexShrink:0},drawerPaper:{width:ve},drawerHeader:Object(I.a)(Object(I.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,maxWidth:"100%",padding:e.spacing(2),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},bottomnav:Object(I.a)({position:"fixed",bottom:0,width:"100%",display:"flex"},e.mixins.toolbar),grow:{flexGrow:1}})}));function we(e){var t=e.changeMode,n=Object(b.a)(),a=Object(D.a)(n.breakpoints.down("sm")),i="dark"===n.palette.type,c=r.a.useState(!1),o=Object(l.a)(c,2),s=o[0],u=o[1],d=r.a.useState({open:!1}),j=Object(l.a)(d,2),p=j[0],h=j[1],m=ye(),x=function(e,t){"clickaway"!==t&&h({open:!1})};return Object(N.jsxs)("div",{className:m.root,children:[Object(N.jsx)(f.a,{}),Object(N.jsxs)(ee.a,{children:[Object(N.jsx)(P.a,{position:"fixed",className:m.appBar+(s&&!a?" "+m.appBarShift:""),children:Object(N.jsxs)(A.a,{children:[Object(N.jsx)(T.a,{color:"inherit","aria-label":"open drawer",onClick:function(){return u(!0)},edge:"start",className:m.menuButton+(s||a?" "+m.hide:""),children:Object(N.jsx)(V.a,{})}),Object(N.jsx)(ee.b,{to:"/",className:m.title,children:Object(N.jsx)(M.a,{variant:"h6",noWrap:!0,children:"\ud83d\udcaf Examinator \u0393! \ud83d\udcaf"})}),Object(N.jsx)("div",{className:m.grow}),Object(N.jsx)(R.a,{title:"Cambia Tema",children:Object(N.jsx)(T.a,{color:"default",edge:"start",onClick:function(){return t(!i)},children:Object(N.jsx)("span",{children:i?"\ud83c\udf1e":"\ud83c\udf1c"})})}),Object(N.jsx)(R.a,{title:"Mis Cosas",children:Object(N.jsx)(ee.b,{to:"/yo",children:Object(N.jsx)(T.a,{color:"default",edge:"end",children:Object(N.jsx)(K.a,{})})})})]})}),Object(N.jsxs)(L.a,{className:m.drawer,variant:"persistent",anchor:"left",open:s&&!a,classes:{paper:m.drawerPaper},children:[Object(N.jsx)("div",{className:m.drawerHeader,children:Object(N.jsx)(T.a,{onClick:function(){return u(!1)},children:"ltr"===n.direction?Object(N.jsx)(J.a,{}):Object(N.jsx)(Y.a,{})})}),Object(N.jsx)(_.a,{}),Object(N.jsxs)(z.a,{children:[Object(N.jsxs)(Q.a,{button:!0,component:ee.c,to:"/preguntas/crear",activeClassName:"Mui-selected",children:[Object(N.jsx)(F.a,{children:Object(N.jsx)(X.a,{})}),Object(N.jsx)(H.a,{primary:"Crear Preguntas"})]}),Object(N.jsxs)(Q.a,{button:!0,component:ee.c,to:"/examen",activeClassName:"Mui-selected",children:[Object(N.jsx)(F.a,{children:Object(N.jsx)(Z.a,{})}),Object(N.jsx)(H.a,{primary:"Hacer Examen"})]}),Object(N.jsxs)(Q.a,{button:!0,component:ee.c,to:"/preguntas/gestionar",activeClassName:"Mui-selected",children:[Object(N.jsx)(F.a,{children:Object(N.jsx)($.a,{})}),Object(N.jsx)(H.a,{primary:"Gestionar Preguntas"})]})]})]}),Object(N.jsxs)("main",{className:m.content+(s&&!a?" "+m.contentShift:""),children:[Object(N.jsx)("div",{className:m.drawerHeader}),Object(N.jsxs)(te.c,{children:[Object(N.jsx)(te.a,{exact:!0,path:"/examen/:id",children:Object(N.jsx)(Fe,{setSnack:h})}),Object(N.jsx)(te.a,{exact:!0,path:"/examen/:id/:index",children:Object(N.jsx)(ze,{setSnack:h})}),Object(N.jsx)(te.a,{path:"/examen",children:Object(N.jsx)(Ie,{setSnack:h})}),Object(N.jsx)(te.a,{path:"/preguntas/crear",children:Object(N.jsx)(qe,{isSmall:a,setSnack:h})}),Object(N.jsx)(te.a,{path:"/preguntas/gestionar/:catname?/:qid?",children:Object(N.jsx)(Oe,{setSnack:h})}),Object(N.jsx)(te.a,{path:"/yo",children:Object(N.jsx)(Xe,{setSnack:h})}),Object(N.jsx)(te.a,{path:"/",children:Object(N.jsx)(Ce,{})})]}),a&&Object(N.jsx)("div",{className:m.drawerHeader})]}),Object(N.jsx)(W.a,{open:p.open,anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:p.hideIn||4e3,onClose:p.onClose||x,children:Object(N.jsx)(ne.a,{onClose:p.onClose||x,severity:p.status||"info",children:p.msg})}),a&&Object(N.jsxs)(G.a,{className:m.bottomnav,showLabels:!0,children:[Object(N.jsx)(U.a,{component:ee.c,to:"/preguntas/crear",activeClassName:"Mui-selected",value:"preguntas",label:"Crear P",icon:Object(N.jsx)(X.a,{})}),Object(N.jsx)(U.a,{component:ee.c,to:"/examen",activeClassName:"Mui-selected",value:"examen",label:"Examen",icon:Object(N.jsx)(Z.a,{})}),Object(N.jsx)(U.a,{component:ee.c,to:"/preguntas/gestionar",activeClassName:"Mui-selected",value:"preguntas",label:"Gestionar P",icon:Object(N.jsx)($.a,{})})]})]})]})}var ke=n(194);function Ce(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(M.a,{variant:"h4",style:{textAlign:"center"},gutterBottom:!0,children:"Bienvenidos al EXAMINATOR! "}),Object(N.jsx)(M.a,{variant:"subtitle1",style:{textAlign:"center"},gutterBottom:!0,children:"Examinator es una herramienta para autoevaluarte de la forma que m\xe1s te guste! Si eres nuevo a la plataforma, solo tienes que seguir los siguientes pasos: "}),Object(N.jsxs)("ol",{children:[Object(N.jsx)("li",{children:Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Introduce tus preguntas (o importalas en formato JSON, de la forma que sigue) en el apartado ",Object(N.jsx)(ke.a,{component:ee.b,to:"/preguntas/crear",children:"Crear Preguntas"})]})}),Object(N.jsx)("div",{children:Object(N.jsx)(de,{style:{margin:"10px 0",overflowY:"auto",maxWidth:"100%",padding:10,display:"inline-flex"},children:Object(N.jsx)("pre",{style:{margin:0},children:'[{\n    "enun": "Aqui se escribe la pregunta, lo has entendido?",\n    "cat":["Prueba1/Sociologia","Biologia","CatPadre/CatHijo"],\n    "resp": ["Respuesta1","Respuesta2","Respuesta3","Si que lo he entendido","No lo he entendido"],\n    "ans": ["Si que lo he entendido","Respuesta2"],\n    "obs": "Se seleccionan las respuestas especificadas porque hemos entendido el concepto."\n},\n{\n    "enun": "Segunda pregunta: 2+2?",\n    "cat":["Prueba2/Matematicas","CatPadre/CatHijo","CatAbuelo/CatPadre/CatHijo"],\n    "resp": ["5","99999","855","6","4"],\n    "ans": ["4"],\n    "obs": "Esto es una observaci\xf3n que s\xf3lo se ver\xe0 al revisar las respuestas de un examen"\n},\n{\n    "enun": "Ultima pregunta: como estas?",\n    "cat":["Prueba3/Psicologia","CatPadre/CatHijo","CatAbuelo/CatPadre/CatHijo"],\n    "resp": ["Bien","Genial","Normal","Content@","Interesada"],\n    "ans": ["Genial","Content@"],\n    "obs": "Podriamos dejar este campo en blanco si quisieramos o no a\xf1adirlo."\n}]'})})}),Object(N.jsx)("li",{children:Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Examinate de las categorias que quieras en el apartado ",Object(N.jsx)(ke.a,{component:ee.b,to:"/examen",children:"Hacer Examen"})]})}),Object(N.jsx)("li",{children:Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Si quieres modificar o deshacerte de alguna pregunta, el apartado ",Object(N.jsx)(ke.a,{component:ee.b,to:"/preguntas/gestionar",children:"Gestionar Preguntas"})," te va a ayudar a ello!"]})}),Object(N.jsx)("li",{children:Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Finalmente, vas a encontrar tus resultados en ",Object(N.jsx)(ke.a,{component:ee.b,to:"/yo",children:"Mis Cosas"})]})}),Object(N.jsxs)(M.a,{variant:"h5",style:{textAlign:"center",marginTop:20},gutterBottom:!0,children:[" A ",Object(N.jsx)("span",{style:{textDecoration:"line-through"},children:"DISFRUTAR"})," ",Object(N.jsx)("strong",{children:"ESTUDIAR"}),"! "]})]})]})}console.log("DBMANAGER:",g);var Se=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100"},flform:{display:"flex",flexDirection:"column",margin:"10px 0","&>.with-margin>*":{margin:10},"&>:not(.with-margin)":{margin:10}}})}));function qe(e){var t=e.isSmall,n=e.setSnack,a=Se(),i=r.a.useRef(null),c=O(),o=r.a.useState(""),d=Object(l.a)(o,2),j=d[0],b=d[1],f=r.a.useState(!0),p=Object(l.a)(f,2),h=p[0],m=p[1],x=r.a.useState(!1),v=Object(l.a)(x,2),y=v[0],w=v[1],k=je({enun:"",cat:[],resp:[],ans:[],obs:""}),S=Object(l.a)(k,2),E=S[0],B=S[1],D=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null===i||void 0===i||null===(a=i.current)||void 0===a||null===(r=a.files)||void 0===r?void 0:r[0]){e.next=3;break}return e.abrupt("return",b("No file selected"));case 3:m(!0),console.log("to read"),(c=new FileReader).readAsText(i.current.files[0]),c.onload=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loaded"),a=t.target.result,e.prev=2,e.delegateYield(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(a),Array.isArray(a)){e.next=3;break}throw"Base is not array";case 3:t=0;case 4:if(!(t<a.length)){e.next=32;break}if("string"===typeof(r=a[t]).enun&&0!==r.enun.length){e.next=10;break}throw'Attribute "enun" del elemento '.concat(t+1," invalido");case 10:if(Array.isArray(r.cat)&&0!==r.cat.length&&!r.cat.find((function(e){return"string"!==typeof e}))){e.next=14;break}throw'Atributo "cat" del elemento '.concat(t+1," invalido");case 14:if(Array.isArray(r.resp)&&0!==r.resp.length&&!r.resp.find((function(e){return"string"!==typeof e}))){e.next=18;break}throw'Atributo "resp" del elemento '.concat(t+1," invalido");case 18:if(Array.isArray(r.ans)&&0!==r.ans.length&&!r.ans.find((function(e){return"string"!==typeof e||-1===r.resp.indexOf(e)}))){e.next=22;break}throw'Atributo "ans" del elemento '.concat(t+1," invalido");case 22:if(r.obs){e.next=26;break}r.obs="",e.next=28;break;case 26:if("string"===typeof r.obs){e.next=28;break}throw'Atributo "obs" del elemento '.concat(t+1," invalido");case 28:r.ans=r.ans.map((function(e){return r.resp.indexOf(e)})).sort((function(e,t){return e-t})).join("|"),t++,e.next=4;break;case 32:return e.next=34,g.createQuestions(a);case 34:b(""),n({open:!0,status:"success",msg:"Preguntas a\xf1adidas!"});case 36:case"end":return e.stop()}}),e)}))(),"t0",4);case 4:e.next=9;break;case 6:e.prev=6,e.t1=e.catch(2),b("Error: "+e.t1.toString());case 9:m(!1);case 10:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(t){return e.apply(this,arguments)}}(),c.onerror=function(e){b("Error: "+t.toString()),m(!1)};case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),w(!0),e.prev=2,!(E.enun&&E.cat.length>0&&E.resp.length>0&&E.ans.length>0)){e.next=10;break}return console.log(E),E.ans=E.ans.sort((function(e,t){return e-t})).join("|"),e.next=8,g.createQuestions(E);case 8:n({open:!0,status:"success",msg:"Pregunta a\xf1adida!"}),B(null);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n({open:!0,status:"error",msg:"Error: "+e.t0.toString()});case 15:w(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsx)("div",{className:a.root,children:Object(N.jsxs)(de,{children:[!t&&Object(N.jsxs)("form",{id:"import-form",className:a.flform,onSubmit:D,autoComplete:"off",children:[Object(N.jsxs)(M.a,{variant:"h6",children:["Importar preguntas (",Object(N.jsx)(ke.a,{href:"/preguntas_modelo.json",download:!0,children:"ejemplo"}),")"]}),Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Si saltan muchos errores y no se te importa, puedes utilizar la herramienta online ",Object(N.jsx)(ke.a,{href:"https://jsonlint.com/",target:"_blank",children:"JSONlint"})," para ver que errores hay en que linea"]}),Object(N.jsxs)("div",{className:"with-margin",style:{display:"flex"},children:[Object(N.jsx)(C.a,{autoFocus:!0,error:!!j,helperText:j,required:!0,type:"file",inputRef:i,variant:"outlined",label:"Fichero con preguntas",onChange:function(){var e,t;return!!(null===i||void 0===i||null===(e=i.current)||void 0===e||null===(t=e.files)||void 0===t?void 0:t[0])&&m(!1)},InputLabelProps:{shrink:!0},inputProps:{accept:"application/json"},style:{flex:1}}),Object(N.jsx)(q.a,{type:"submit",variant:"contained",color:"primary",disabled:h,children:"Importar"})]})]}),!t&&Object(N.jsx)(M.a,{variant:"h5",style:{textAlign:"center"},children:"O"}),Object(N.jsxs)("form",{id:"create-form",className:a.flform,noValidate:!0,onSubmit:P,autoComplete:"off",children:[Object(N.jsx)(M.a,{variant:"h6",children:"Crear preguntas"}),Object(N.jsx)(C.a,{required:!0,multiline:!0,error:y&&!E.enun,label:"Enunciado",value:E.enun,onChange:function(e){return B({enun:e.target.value})},helperText:y&&!E.enun?"Un problema necessita su enunciado":"",variant:"outlined"}),Object(N.jsx)(se.a,{freeSolo:!0,multiple:!0,value:E.cat,onChange:function(e,t){B({cat:t})},options:c||[],defaultValue:[],style:{display:"flex"},renderTags:function(e,t){return e.map((function(e,n){return Object(N.jsx)(ce.a,Object(I.a)({variant:"outlined",label:e},t({index:n})))}))},renderInput:function(e){return Object(N.jsx)(C.a,Object(I.a)(Object(I.a)({},e),{},{variant:"outlined",label:"Categorias",style:{flex:"1",maxWidth:"100%"},multiline:!0,error:y&&0===E.cat.length,helperText:y&&0===E.cat.length?"Introduce al menos una categoria":""}))}}),E.resp.map((function(e,t){return Object(N.jsx)(C.a,{required:!0,multiline:!0,label:"Respuesta "+(t+1),variant:"outlined",size:"small",value:e,onChange:function(e){return B({resp:function(n){return n[t]=e.target.value}})},error:y&&!e,helperText:y&&!e?"No pueden haber respuestas vacias! Si no te gusta, elim\xednala":"",InputProps:{endAdornment:Object(N.jsxs)(oe.a,{position:"end",children:[Object(N.jsx)(T.a,{"aria-label":"Marcar como respuesta correcta",onClick:function(){return B({ans:function(e){var n=e.indexOf(t);-1===n?e.push(t):e.splice(n,1)}})},edge:"start",children:-1!==E.ans.indexOf(t)?Object(N.jsx)(pe.a,{style:{color:"#00c100"}}):Object(N.jsx)(he.a,{})}),Object(N.jsx)(T.a,{"aria-label":"Eliminar respuesta",onClick:function(){return B({ans:function(e){var n=e.indexOf(t);-1!==n&&e.splice(n,e.index)},resp:function(e){return e.splice(t,1)}})},edge:"end",children:Object(N.jsx)(me.a,{})})]})}},t)})),Object(N.jsx)(q.a,{variant:"outlined",color:"primary",style:{width:"fit-content",margin:10},onClick:function(){return B({resp:function(e){return e.push("")}})},children:"A\xf1adir respuesta"}),Object(N.jsx)(C.a,{multiline:!0,label:"Observaciones",value:E.obs,onChange:function(e){return B({obs:e.target.value})},variant:"outlined"}),Object(N.jsx)(q.a,{type:"submit",variant:"contained",color:"primary",style:{width:"fit-content",alignSelf:"center"},children:"Crear"})]})]})})}var Ne=n(195),Ee=n(196),Be=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},paper:{maxHeight:"40vh",overflow:"auto"},flform:{display:"flex",flexDirection:"column",margin:"10px 0","&>.with-margin>*":{margin:10},"&>:not(.with-margin)":{margin:10}},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})}));function Ie(e){var t=e.setSnack,n=Be(),a=O(),i=Object(te.f)(),c=r.a.useState(!1),o=Object(l.a)(c,2),d=o[0],j=o[1],b=r.a.useState(!1),f=Object(l.a)(b,2),p=f[0],h=f[1],m=je({time:!1,qtime:!1}),x=Object(l.a)(m,2),v=x[0],y=x[1],w=je({qnum:10,time:"",qtime:"",randtype:"true_random",cat:[],que:[],qpans:[],ans:[],res:[]}),k=Object(l.a)(w,2),S=k[0],E=k[1],B=function(){var e=Object(u.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),h(!0),e.prev=2,!(S.qnum&&S.time>0&&S.randtype&&S.cat.length>0)){e.next=14;break}return j(!0),console.log(S),e.next=8,g.createExam(S);case 8:if(!(a=e.sent)){e.next=13;break}return e.abrupt("return",i.push("/examen/".concat(a,"/1")));case 13:throw Error("There was an exception creating the exam");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),t({open:!0,status:"error",msg:"Error: "+e.t0.toString()});case 20:j(!1);case 21:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsxs)("div",{className:n.root,children:[Object(N.jsx)(de,{children:a&&a.length>0?Object(N.jsxs)("form",{id:"doexam-form",className:n.flform,onSubmit:B,autoComplete:"off",children:[Object(N.jsx)(M.a,{variant:"h6",children:"Configura tu examen y ya puedes empezar!"}),Object(N.jsx)(se.a,{freeSolo:!0,multiple:!0,value:S.cat,onChange:function(e,t){E({cat:t})},options:a,defaultValue:[],style:{display:"flex"},renderTags:function(e,t){return e.map((function(e,n){return Object(N.jsx)(ce.a,Object(I.a)({variant:"outlined",label:e},t({index:n})))}))},renderInput:function(e){return Object(N.jsx)(C.a,Object(I.a)(Object(I.a)({},e),{},{variant:"outlined",label:"Categorias",style:{flex:"1",maxWidth:"100%"},multiline:!0,error:p&&0===S.cat.length,helperText:p&&0===S.cat.length?"Introduce al menos una categoria":""}))}}),Object(N.jsxs)(C.a,{select:!0,disabled:!0,variant:"outlined",label:"Modo elecci\xf3n de preguntas",value:S.randtype,onChange:function(e){return E({randtype:e.target.value})},children:[Object(N.jsx)(Ne.a,{value:"equal_split",children:"Proporcional entre categorias"}),Object(N.jsx)(Ne.a,{value:"proportional",children:"Segun n\xfamero de preguntas en categoria"}),Object(N.jsx)(Ne.a,{value:"true_random",children:"Totalmente aleatorio"})]}),Object(N.jsx)(C.a,{label:"N\xfamero de preguntas",type:"number",variant:"outlined",error:p&&!S.qnum,value:S.qnum,onChange:function(e){return E({qnum:e.target.value})},InputLabelProps:{shrink:!0}}),Object(N.jsx)(C.a,{label:"Duraci\xf3n del test (minutos)",type:"number",variant:"outlined",error:p&&!S.time,value:S.time&&S.time/6e4,onChange:function(e){var t=e.target.value;y({time:!!t}),E({time:t?6e4*+t:"",qtime:v.qtime&&S.qtime||!t?null:Math.floor(6e4*+t/S.qnum)})},InputLabelProps:{shrink:!0}}),Object(N.jsx)(C.a,{label:"Duraci\xf3n de pregunta (segundos)",type:"number",variant:"outlined",error:p&&!S.qtime,value:S.qtime&&S.qtime/1e3,onChange:function(e){var t=e.target.value;y({qtime:!!t}),E({qtime:t?1e3*+t:"",time:v.time&&S.time||!t?null:1e3*+t*S.qnum})},InputLabelProps:{shrink:!0}}),Object(N.jsx)(q.a,{type:"submit",variant:"contained",color:"primary",style:{width:"fit-content",alignSelf:"center"},children:"Empezar!"})]}):Object(N.jsxs)("div",{children:[Object(N.jsx)(M.a,{variant:"h6",children:"Faltan preguntas!"}),Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,children:["Introduce tus preguntas (o importalas en formato JSON) en el apartado ",Object(N.jsx)(ke.a,{component:ee.b,to:"/preguntas/crear",children:"Crear Preguntas"})]})]})}),Object(N.jsx)(ie.a,{className:n.backdrop,open:d||!a,children:Object(N.jsx)(Ee.a,{color:"secondary"})})]})}var De=n(13),Pe=n(164),Ae=n(197),Te=n(198),Me=n(211),Re=n(199),Le=Object(v.a)((function(e){var t;return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},paper:(t={},Object(De.a)(t,e.breakpoints.up("md"),{minWidth:"50%"}),Object(De.a)(t,"minWidth","100%"),t),questions:{display:"flex",flexDirection:"column"},errdiv:{textAlign:"center","&>h1":{fontFamily:"monospace"}},formControl:{margin:e.spacing(3)},topProgress:{position:"absolute"}})})),_e=function(e){var t=(Date.now()-e)/1e3,n=Math.floor(t/3600);t-=3600*n;var a=Math.floor(t/60)%60;t-=60*a;var r=Math.floor(t%60);return"".concat(n>99?n:("00"+n).slice(-2),":").concat(("00"+a).slice(-2),":").concat(("00"+r).slice(-2))};function ze(e){var t=e.setSnack,n=Le(),i=Object(te.f)(),c=r.a.useState(""),o=Object(l.a)(c,2),d=o[0],j=o[1],b=r.a.useState({}),f=Object(l.a)(b,2),h=f[0],m=f[1],x=r.a.useState([]),O=Object(l.a)(x,2),v=O[0],y=O[1],w=r.a.useState([]),k=Object(l.a)(w,2),S=k[0],q=k[1],E=r.a.useState({}),B=Object(l.a)(E,2),I=B[0],D=B[1],P=r.a.useState({etxt:"Exam Time: X",qtxt:"Question Time: Y",qtime:0,etime:0,ended:!1}),A=Object(l.a)(P,2),L=A[0],_=A[1],z=r.a.useRef(Date.now()),Q=r.a.useRef(NaN),F=Object(te.g)(),H=F.id,W=F.index;Object(a.useEffect)((function(){var e=function(e){console.error(e),j(e.toString())};try{if(j(""),h.id&&h.id===H||g.getExam(H).then((function(e){if(!e)throw"Can't get Exam - Is the ID correct?";return m(e),e})).then((function(e){if(+W<0||+W>e.que.length)throw"Index Out Of Bounds";return I.id&&I.id===e.que[+W-1]?I:g.getQuestion(e.que[+W-1])})).then((function(e){return e?D(e):j("Can't get Question - Is the ID correct?")})).catch(e),h.id){if(+W<0||+W>h.que.length)throw"Index Out Of Bounds";I.id&&I.id===h.que[+W-1]||g.getQuestion(h.que[+W-1]).then((function(e){return e?D(e):j("Can't get Question - Is the ID correct?")})).catch(e)}}catch(t){e(t)}}),[H,W]),Object(a.useEffect)((function(){if(h.id?q(h.res[+W-1]?h.res[+W-1].split("|"):[]):q([]),I.id){var e=I.resp.map((function(e,t){return[e,t.toString()]}));if(h.end||Date.now()>h.start+h.time)_({txt:"Exam Ended",qtime:0,etime:0,ended:!0}),y(e);else{y(function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}return e}(e)),z.current=Date.now(),isNaN(Q.current)||clearInterval(Q.current);var t=setInterval(G,1e3);Q.current=t}}else y([]),isNaN(Q.current)||clearInterval(Q.current),Q.current=NaN}),[I]);var G=function(){if(h.id&&I.id){var e=!h.end&&Date.now()>h.start+h.time;if(e)return console.log("time seems ended",e),_({txt:"Exam Ended",qtime:0,etime:0,ended:!0}),isNaN(Q.current)||clearInterval(Q.current),void(Q.current=NaN);var t=Date.now();_({etxt:"Exam Time: "+_e(+h.start),qtxt:"Question Time: "+_e(z.current),etime:Math.min(Math.ceil(100*(t-h.start)/h.time),100),qtime:Math.min(Math.floor(100*(t-z.current)/h.qtime),100),ended:e})}},U=function(e){return function(){var t=S.indexOf(e),n=[];-1===t?n=[].concat(Object(p.a)(S),[e]):(n=Object(p.a)(S)).splice(t,1),V(n),q(n)}},V=function(e){return g.saveAnswer(h,+W-1,e.sort((function(e,t){return+e-+t})).join("|")).catch((function(e){return t({open:!0,status:"error",msg:"Error en guardado de la pregunta en DB:\n"+e.toString()})}))},K=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.endExam(h);case 3:i.push("/examen/"+h.id),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t({open:!0,status:"error",msg:"Error en acabar examen:\n"+e.t0.toString()});case 9:case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),X=function(e){if(L.ended){var t="|",n=t+h.ans[+W-1]+t,a=-1!==S.indexOf(e),r=-1!==n.indexOf(t+e+t);if(0===S.length){if(r)return{backgroundColor:"#ff980080"}}else{if(a&&r)return{backgroundColor:"#4caf5080"};if(a&&!r||!a&&r)return{backgroundColor:"#f4433680"}}}};return Object(N.jsx)("div",{className:n.root,children:Object(N.jsx)(de,{className:(L.ended?"colorful-disabled ":"")+n.paper,children:d?Object(N.jsxs)("div",{className:n.errdiv,children:[Object(N.jsx)(M.a,{variant:"h1",children:"404"}),Object(N.jsx)(M.a,{variant:"body1",gutterBottom:!0,children:d})]}):h.id&&I.id?Object(N.jsxs)("div",{className:n.questions,children:[Object(N.jsxs)(M.a,{variant:"h6",children:["Pregunta ",W," de ",h.que.length]}),Object(N.jsx)(M.a,{variant:"body1",gutterBottom:!0,children:I.enun}),Object(N.jsx)(Pe.a,{component:"fieldset",className:n.formControl,disabled:L.ended,children:Object(N.jsx)(Ae.a,{children:v.map((function(e){return Object(N.jsx)(Te.a,{style:X(e[1]),control:Object(N.jsx)(Me.a,{checked:-1!==S.indexOf(e[1]),onChange:U(e[1]),name:"resp_"+e[1]}),label:e[0]},e[1])}))})}),L.ended&&!!I.obs&&Object(N.jsx)(C.a,{style:{marginBottom:10},multiline:!0,disabled:!0,label:"Observaciones",value:I.obs,variant:"outlined"}),Object(N.jsxs)("div",{className:n.root,style:{justifyContent:"space-evenly"},children:[Object(N.jsx)(R.a,{title:"Pregunta Anterior",children:Object(N.jsx)(T.a,{disabled:"1"===W,color:"default",edge:"start",component:ee.b,to:"/examen/".concat(H,"/").concat(+W-1),children:Object(N.jsx)(J.a,{})})}),L.ended?Object(N.jsx)(R.a,{title:"Resumen del Examen",children:Object(N.jsx)(T.a,{color:"default",component:ee.b,to:"/examen/".concat(H),children:Object(N.jsx)(Re.a,{})})}):Object(N.jsxs)("div",{className:n.root,children:[Object(N.jsx)(R.a,{title:L.etxt,children:Object(N.jsx)(Ee.a,{color:"primary",size:80,thickness:20,variant:"determinate",value:L.etime})}),Object(N.jsx)(R.a,{title:L.qtxt,children:Object(N.jsx)(Ee.a,{className:n.topProgress,color:"secondary",size:40,thickness:20,variant:"determinate",value:L.qtime})})]}),+W!==h.que.length||L.ended?Object(N.jsx)(R.a,{title:"Pregunta Siguiente",children:Object(N.jsx)(T.a,{disabled:+W===h.que.length,color:"default",edge:"end",component:ee.b,to:"/examen/".concat(H,"/").concat(+W+1),children:Object(N.jsx)(Y.a,{})})}):Object(N.jsx)(R.a,{title:"Acabar Examen",children:Object(N.jsx)(T.a,{color:"default",edge:"end",onClick:K,children:Object(N.jsx)(Z.a,{})})})]})]}):Object(N.jsx)(Ee.a,{color:"secondary"})})})}var Qe=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},question:{display:"inline-flex",justifyContent:"center",alignItems:"center",height:40,width:40,margin:10},mark:{display:"flex",justifyContent:"center"},counting:{display:"flex",justifyContent:"space-between"}})}));function Fe(e){var t=e.setSnack,n=Qe(),i=r.a.useState(),c=Object(l.a)(i,2),o=c[0],s=c[1],u=r.a.useState({good:0,bad:0,empty:0,mark:0}),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(te.g)().id;Object(a.useEffect)((function(){g.getExam(f).then((function(e){s(e),p(e)})).catch((function(e){t({open:!0,status:"error",msg:"Error en obtener examen:\n"+e.toString()})}))}),[f]);var p=function(e){var t=0,n=0,a=0,r=0;return e.res.forEach((function(i,c){i===e.ans[c]?t++:i?(n++,r+=1/(e.qpans[c]-1)):a++})),b({mark:(t-r)/e.ans.length*10,good:t,bad:n,empty:a})};return Object(N.jsx)("div",{className:n.root,children:Object(N.jsxs)(de,{children:[Object(N.jsxs)(M.a,{variant:"h6",gutterBottom:!0,children:["Examen del ",o&&new Date(o.start).toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"})]}),Object(N.jsx)(M.a,{variant:"body1",gutterBottom:!0,className:n.mark,children:Object(N.jsxs)("span",{children:["Nota: ",Object(N.jsxs)("strong",{children:[j.mark," / 10"]})]})}),Object(N.jsxs)(M.a,{variant:"body1",gutterBottom:!0,className:n.counting,children:[Object(N.jsxs)("span",{children:["Aciertos: ",Object(N.jsx)("strong",{children:j.good})]}),Object(N.jsxs)("span",{children:["Fallos: ",Object(N.jsx)("strong",{children:j.bad})]}),Object(N.jsxs)("span",{children:["En blanco: ",Object(N.jsx)("strong",{children:j.empty})]})]}),Object(N.jsx)("div",{children:null===o||void 0===o?void 0:o.res.map((function(e,t){return Object(N.jsx)(ke.a,{component:ee.b,underline:"none",to:"/examen/".concat(f,"/").concat(t+1),children:Object(N.jsx)(ue.a,{elevation:4,className:n.question,style:{backgroundColor:e?e===o.ans[t]?"#4caf50":"#f44336":"#ff9800"},children:Object(N.jsx)(M.a,{variant:"h6",children:t+1})})},t)}))}),j.bad>0&&Object(N.jsx)("div",{children:Object(N.jsx)(q.a,{variant:"outlined",color:"primary",style:{width:"fit-content",margin:10},onClick:function(){if(o){var e=o.res.reduce((function(e,t,n){return t&&t!==o.ans[n]&&e.push(o.que[n]),e}),[]);g.addCategoryToQuestion(e,"falladas").then((function(){return t({open:!0,status:"success",msg:"Preguntas a\xf1adidas correctamente"})})).catch((function(e){return t({open:!0,status:"error",msg:"Error en a\xf1adir preguntas:\n"+e.toString()})}))}},children:'A\xf1adir preguntas falladas a categoria "falladas"'})})]})})}var He=n(200),We=n(201),Ge=n(202),Ue=n(203),Ve=n(204),Ke=n(205),Je=n(206),Ye=Object(v.a)((function(e){return Object(y.a)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},question:{display:"inline-flex",justifyContent:"center",alignItems:"center",height:40,width:40,margin:10},mark:{display:"flex",justifyContent:"center"},counting:{display:"flex",justifyContent:"space-between"}})}));function Xe(e){var t=e.setSnack,n=Ye(),i=r.a.useState(),c=Object(l.a)(i,2),o=c[0],s=c[1],u=r.a.useState({good:0,bad:0,empty:0,mark:0}),d=Object(l.a)(u,2);d[0],d[1],Object(te.g)().id;Object(a.useEffect)((function(){g.getExams().then((function(e){return s(e.map((function(e){return e.result=j(e),e})))})).catch((function(e){t({open:!0,status:"error",msg:"Error en obtener examen:\n"+e.toString()})}))}),[]);var j=function(e){var t=0,n=0,a=0,r=0;return e.res.forEach((function(i,c){i===e.ans[c]?t++:i?(n++,r+=1/(e.qpans[c]-1)):a++})),{mark:(t-r)/e.ans.length*10,good:t,bad:n,empty:a}};return Object(N.jsx)("div",{className:n.root,children:Object(N.jsx)(He.a,{component:ue.a,children:Object(N.jsxs)(We.a,{"aria-label":"exam table",children:[Object(N.jsx)(Ge.a,{children:Object(N.jsxs)(Ue.a,{children:[Object(N.jsx)(Ve.a,{children:"ID"}),Object(N.jsx)(Ve.a,{children:"Date"}),Object(N.jsx)(Ve.a,{align:"right",children:"Mark"}),Object(N.jsx)(Ve.a,{align:"center",children:"View"})]})}),Object(N.jsx)(Ke.a,{children:null===o||void 0===o?void 0:o.map((function(e){var t;return Object(N.jsxs)(Ue.a,{children:[Object(N.jsx)(Ve.a,{component:"th",scope:"row",children:e.id}),Object(N.jsx)(Ve.a,{children:new Date(e.start).toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric"})}),Object(N.jsxs)(Ve.a,{align:"right",children:[null===(t=e.result)||void 0===t?void 0:t.mark," / 10"]}),Object(N.jsx)(Ve.a,{align:"center",children:Object(N.jsx)(ee.b,{to:"/examen/".concat(e.id),children:Object(N.jsx)(T.a,{color:"default",edge:"end",children:Object(N.jsx)(Je.a,{})})})})]},e.id)}))})]})})})}var Ze=n(68),$e=n(207);n(116);var et=function(){var e=r.a.useState(matchMedia("(prefers-color-scheme: dark)").matches),t=Object(l.a)(e,2),n=t[0],a=t[1],i=r.a.useMemo((function(){return Object(d.a)({palette:{type:n?"dark":"light",primary:Ze.a,secondary:$e.a}})}),[n]),c=r.a.useState(!1),o=Object(l.a)(c,2),b=o[0],f=o[1],p=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","No API Key Specified");case 2:return e.next=4,g.login(t);case 4:return n=e.sent,f(!n),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsx)(j.a,{theme:i,children:b?Object(N.jsx)(we,{changeMode:a}):Object(N.jsx)(B,{doLogIn:p})})},tt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,216)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};c.a.render(Object(N.jsx)(r.a.StrictMode,{children:Object(N.jsx)(et,{})}),document.getElementById("root")),tt()}},[[117,1,2]]]);
//# sourceMappingURL=main.0516a3a6.chunk.js.map